# 源码编译

​	使用源码编译则默认你已熟悉git、cmake、npm、gcc或msvc、Qt等工具的使用。

## 一、构建后端

### 1. 安装依赖

#### Drogon

后端服务依赖于drogon框架，[点此](https://drogonframework.github.io/drogon-docs/#/CHN/CHN-02-%E5%AE%89%E8%A3%85)查看drogon官方文档并完成安装

#### OpenCV

点[这里](https://opencv.org/releases/)获取安装及说明文档

### 2. 拉取代码并构建

```bash
git clone https://github.com/jin-ct/stufbsys.git
cd stufbsys/server
mkdir build
cd build
cmake ..
# gcc构建
make
```

若使用msvc，cmake后在build目录下找到.sln文件并使用vs打开，即可点击编译按钮完成编译。

### 3. 添加配置文件

将`stuFBSys`可执行文复制到任意目录作为安装目录，再把源码目录下的`config.json`配置文件复制到安装目录，按需修改配置文件，在安装目录下创建`log`目录，最后运行`stuFBSys`可执行文件即可

## 二、构建前端

前端有三个项目，分别为front下的admin（管理后台）、teacherAdmin（教师管理后台）、reception（前台）

```bash
cd front/admin
pnpm install # 安装依赖
pnpm run build
```

```bash
cd front/teacherAdmin
pnpm install
pnpm run build
```

```bash
cd front/reception
npm install
npm run build
```

> [!NOTE]
>
> 需要注意，admin和teacherAdmin项目基于[Pure Admin](https://pure-admin.cn/)，其使用的是pnpm，而reception项目使用npm

同目录下dist文件夹即是构建产物，通常建议使用以下目录结构

```
网站根目录
|--- admin           # admin项目构建产物
|--- teacherAdmin    # teacherAdmin项目构建产物
└─-- ···             # reception项目构建产物
```

## 三、配置工具、一键部署工具构建（可选）

使用Qt Creator打开tools目录下各项目的CMakeLists.txt并点击构建即可，也可自行选择其他构建方式。

> [!NOTE]
>
> 在installer（一键部署工具）项目中，请按照package/README.txt的说明添加安装压缩包
